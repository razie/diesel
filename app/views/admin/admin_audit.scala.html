@***
purge audit tables
***@
@(implicit au:Option[model.User])

@fufu(db:com.mongodb.casbah.Imports.DBObject, k:String, v:String) = {
  @k match {
    case "cleared" => {
    <a href="/razadmin/clearaudit/@db.get("_id").toString">clear</a>
    }
   case "msg" if (db.containsField("link")) => {
    <a href="@db.get("link").toString">@v</a>
    }
    case _ => { @v }
    }
}

@htmlHeadBar("admin audit", au)

  <div class="container">

    <h2>Audit events</h2>

    @util.utilTable("Audit", Seq("level"->"L", "when"->"When", "msg"->"What", "cleared"->"Done", "details"->"Details"),None,Some("when"), Some(fufu))

    <hr>
    <a href="/razadmin/clearauditall">clear all</a>
    <hr>
      
    @htmlFooter()

  </div> <!-- /container -->

  @htmlBottom()
    