@******
manage the volunteer hours by club admin
******@
@(reg:mod.snow.Reg, rkas:List[mod.snow.RacerKidAssoc], myForm: Form[_], club:controllers.Club)(implicit stok:controllers.StateOk)
@import mod.snow.VH
@import mod.snow.RacerKidz
@import mod.snow.RacerKidAssoc
@import org.bson.types.ObjectId

@user=@{stok.au.get}

@stok.title("Volunteer hours")

@vols=@{
  for (
      rka <- rkas;
      vh <- RacerKidz.findVolByRkaId(rka._id.toString)) yield
    Map("rkaId" -> rka._id.toString,
        "who" -> rka.rk.get.info.ename,
        "hours"->vh.hours.toString,
        "desc"->vh.desc,
        "comment"->vh.comment,
        "approved"->vh.status,
        "delete"-> (if(vh.status == VH.ST_OK) "" else vh._id.toString)
        )
}

@mnglink(row:Map[String,String],k:String,v:String)={
  @k match {
    case "delete" => {
        @if(! v.isEmpty) {
          <a href="@routes.Club.doeVolDelete(club.name, reg._id.toString, v)" class="btn btn-xs btn-danger"> x </a>
        }
      }

    case _ => { @v }
  }
}

<h3>Current volunteer hour submissions</h3>

@util.utilSimpleTable(vols.iterator,
  Seq("who" -> "Who", "hours" -> "Hours", "desc"->"What", "comment" -> "Desc", "approved" -> "Ok", "delete" -> "Delete"), Some(mnglink))

@import helper.twitterBootstrap._
@import play.api.Play.current
@import play.api.i18n.Messages.Implicits._
@import util.razText

@club.props.get("VolunteerMessage").map { m =>
  <div class="well">@m </div>
}

@helper.form(action=routes.Club.doeVolAdded(club.name, reg._id.toString), 'class->"well") {
<h3>Submit more hours:</h3>
<table>
    <tr>
        <td>
            <label>Who</label>
            <select class="input-small" name="who">
            @rkas.map { rka =>
                <option value="@rka._id.toString">@rka.rk.get.info.ename</option>
            }
            </select>
        </td>
        <td>
            <label>Hours</label>
            <input type="text" class="input-small" name="hours">
        </td>
        <td>
        <label>Category</label>
        <select class="input-small" name="desc">
        @club.volunteering.map { rka =>
            <option value="@rka">@rka</option>
        }
        </select>
        </td>
        <td>
            <label>Approver</label>
            <select class="input-small" name="approver">
            @club.approvers.map { t =>
                <option value="@t._2">@t._1</option>
            }
            </select>

        </td>
    </tr>
</table>
<br>
  <label>Description (when, where, what)</label><br>
    <textarea lines=3 cols=30 class="input-xxlarge" name="comment"></textarea>
  <br>
  <button type="submit" class="btn btn-primary"> Submit hours </button>
}

